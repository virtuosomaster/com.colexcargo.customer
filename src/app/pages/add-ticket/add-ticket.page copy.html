<ion-header [translucent]="true">
  <ion-toolbar color="clear">
    <ion-buttons slot="secondary" style="width:100%;">
      <ion-menu-button></ion-menu-button>
      <ion-button (click)="goToShipments()">
        <ion-icon slot="icon-only" name="arrow-back-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-margin">
  <ion-text color="clear">
    <h1 class="ion-text-start title ion-margin">SUPPORT DESK</h1>
  </ion-text>

  <ion-text color="clear">
    <h3 class="ion-text-start title ion-margin">Support Desk</h3>
  </ion-text>

  <section class="main-data">
    <ion-grid class="backgrounded">
      <div class="header-back">
        <ion-text color="primary">
          <h4 class="ion-no-margin">Add Entry Here</h4>
        </ion-text>
      </div>

      <form class="ion-margin" [formGroup]="addTicketForm">
        <ion-row>
          <ion-col size="12">
            <ion-label position="floating">Country<span class="error-text">*</span></ion-label>
          </ion-col>
          <ion-col size="12">
            <ion-input class="input-sm" formControlName="ticket_country" type="text" required> </ion-input>
          </ion-col>
          <div class="error-container">
            <ng-container *ngFor="let validation of validation_messages.ticket_country">
              <div class="error-message"
                *ngIf="addTicketForm.get('ticket_country').hasError(validation.type) && (addTicketForm.get('ticket_country').dirty || addTicketForm.get('ticket_country').touched)">
                <ion-icon name="information-circle-outline"></ion-icon>
                <span class="error-text">{{ validation.message }}</span>
              </div>
            </ng-container>
          </div>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <ion-label position="floating">Category</ion-label>
          </ion-col>
          <ion-col size="12">
            <ion-select (ionChange)="categoryChange($event)" placeholder="Select a Category" class="input-sm"
              interface="popover" justify="space-between" required toggleIcon="add" expandedIcon="remove"
              aria-label="Select a Category">
              <ion-select-option value="buying_service">Buying Service</ion-select-option>
              <ion-select-option value="delivery">Delivery</ion-select-option>
              <ion-select-option value="payment_information">Payment Information</ion-select-option>
              <ion-select-option value="promotions">Promotions</ion-select-option>
              <ion-select-option value="registration">Registration</ion-select-option>
              <ion-select-option value="prohibited_items">Prohibited Items</ion-select-option>
              <ion-select-option value="rewards_and_benefits">Rewards and Benefits</ion-select-option>
              <ion-select-option value="shipping">Shipping</ion-select-option>
              <ion-select-option value="shipping_rates">Shipping Rates</ion-select-option>
              <ion-select-option value="shopping">Shopping</ion-select-option>
              <ion-select-option value="others">Others</ion-select-option>
            </ion-select>
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <ion-label position="floating">Tracking Number<span class="error-text">*</span></ion-label>
          </ion-col>
          <ion-col size="12">
            <ion-input class="input-sm" formControlName="ticket_tracking" type="text" required> </ion-input>
          </ion-col>
          <div class="error-container">
            <ng-container *ngFor="let validation of validation_messages.ticket_tracking">
              <div class="error-message"
                *ngIf="addTicketForm.get('ticket_tracking').hasError(validation.type) && (addTicketForm.get('ticket_tracking').dirty || addTicketForm.get('ticket_tracking').touched)">
                <ion-icon name="information-circle-outline"></ion-icon>
                <span class="error-text">{{ validation.message }}</span>
              </div>
            </ng-container>
          </div>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <ion-label position="floating">Warehouse</ion-label>
          </ion-col>
          <ion-col size="12">
            <ion-select (ionChange)="warehouseChange($event)" placeholder="Select a Warehouse" class="input-sm"
              interface="popover" justify="space-between" required toggleIcon="add" expandedIcon="remove"
              aria-label="Select a Warehouse">
              <ion-select-option value="2">Japan</ion-select-option>
              <ion-select-option value="3">US</ion-select-option>
            </ion-select>
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <ion-label position="floating">Subject<span class="error-text">*</span></ion-label>
          </ion-col>
          <ion-col size="12">
            <ion-input class="input-sm" formControlName="ticket_subject" type="text" required> </ion-input>
          </ion-col>
          <div class="error-container">
            <ng-container *ngFor="let validation of validation_messages.ticket_subject">
              <div class="error-message"
                *ngIf="addTicketForm.get('ticket_subject')?.hasError(validation.type) && (addTicketForm.get('ticket_subject')?.dirty || addTicketForm.get('ticket_subject')?.touched)">
                <ion-icon name="information-circle-outline"></ion-icon>
                <span class="error-text">{{ validation.message }}</span>
              </div>
            </ng-container>
          </div>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <ion-label position="floating">Concerns/Questions<span class="error-text">*</span></ion-label>
          </ion-col>
          <ion-col size="12">
            <ion-textarea formControlName="ticket_comment" required class="input-sm-textarea"
              placeholder="Add your comment here"> </ion-textarea>
          </ion-col>
          <div class="error-container">
            <ng-container *ngFor="let validation of validation_messages.ticket_comment">
              <div class="error-message"
                *ngIf="addTicketForm.get('ticket_comment')?.hasError(validation.type) && (addTicketForm.get('ticket_comment')?.dirty || addTicketForm.get('ticket_comment')?.touched)">
                <ion-icon name="information-circle-outline"></ion-icon>
                <span class="error-text">{{ validation.message }}</span>
              </div>
            </ng-container>
          </div>
        </ion-row>

        <ion-row>
          <ion-col size="12" class="ion-text-center bordered">
            <div class="img-input-container">
              <img src="../../../assets/images/cloud-computing.png" (click)="pickFile()" />
            </div>
            <ion-text class="ion-text-center">Upload your files here</ion-text>
          </ion-col>
        </ion-row>

        <ion-row>
          @for (file of files; track file) {
          <ion-col size="12">
            <ion-input label="Name" type="text" readonly [value]="file.name"></ion-input>
          </ion-col>
          <ion-col size="12" class="hidden">
            <ion-input label="Path" type="hidden" readonly [value]="file.path"></ion-input>
          </ion-col>
          <ion-col size="12">
            <ion-input label="Mime Type" type="text" readonly [value]="file.mimeType"></ion-input>
          </ion-col>
          <ion-col size="12" class="hidden">
            <ion-input label="Size" type="hidden" readonly [value]="file.size"></ion-input>
          </ion-col>
          <ion-col size="12" class="hidden">
            <ion-input label="Data" type="hidden" readonly [value]="file.data"></ion-input>
          </ion-col>
          <ion-col size="12" class="hidden">
            <ion-input label="Duration" type="hidden" readonly [value]="file.duration"></ion-input>
          </ion-col>
          <ion-col size="12" class="hidden">
            <ion-input label="Height" type="hidden" readonly [value]="file.height"></ion-input>
          </ion-col>
          <ion-col size="12" class="hidden">
            <ion-input label="Width" type="hidden" readonly [value]="file.width"></ion-input>
          </ion-col>
          @if (file.path) {
          <img [src]="file.path | fileSource" />
          }
          }
        </ion-row>

        <ion-row class="ion-text-right">
          <ion-col size="12">
            <ion-button class="button-sm" type="submit" (click)="submitaddTicket()">Submit</ion-button>
          </ion-col>
        </ion-row>
      </form>
    </ion-grid>
  </section>
</ion-content>